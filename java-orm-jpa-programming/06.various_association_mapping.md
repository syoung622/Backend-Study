### 다양한 연간관계 매핑

#### 다대일

- 단방향 ERD

![1](https://user-images.githubusercontent.com/68267278/166139752-d232d9c6-4adb-4947-bb15-12a26062ea5b.png)

    - Member 객체가 Team 객체를 참조

- 양방향 ERD

![2](https://user-images.githubusercontent.com/68267278/166139754-dafbc297-ecce-4087-8bf5-dd24109ea7a3.png)

    - 외래키가 있는 쪽이 연관관계의 주인
    - 양쪽을 서로 참조하도록 member list를 추가

    ``` java
    @OneToMany
    private List<Member> members = new ArrayList<>();
    ```
    - 연관관계 주인이 아닌 쪽은 단순 조회만 가능


#### 일대다

- 일이 연관관계의 주인(권장 x)

    - 테이블에서는 항상 다 쪽에 외래키가 존재하므로 패러다임 충돌
    - `@JoinColumn` 사용 필수
    - 테이블의 수가 많아지면 관리 어려움
    (추가적인 update query 실행됨.)

#### 일대일

- 주 테이블, 대상 테이블 중 외래키 선택 가능
    - 주 테이블 외래키
        - 객체지향개발
        - JPA 매핑에 편리
        - 주 테이블만 조회해도 대상 테이블의 데이터 존재 확인 가능
        - 값이 없는 경우 외래키에 null 허용
    - 대상 테이블 외래키
        - DB 위주의 개발
        - 주 테이블과 대상 테이블을 일대일에서 일대다 관계로 변경할 시 테이블 구조 유지 가능
        - 주 테이블에는 외래키가 없으므로 대상 테이블이 존재하는지 알기 위해 즉시 로딩 필수
- 외래키에 UNIQUE 제약조건 추가
- 외래키가 있는 쪽이 연관관계의 주인


#### 다대다

- 실무에서 거의 사용되지 않음.
- `@ManyToMany`
- `@JoinTable`: 연결 테이블 지정

##### 다대다 매핑의 한계

- 다대다 매핑을 위한 중간 테이블이 단순 연결로 끝나지 않고 테이블에 추가적인 데이터를 넣어야 하는 상황 발생할 수 있음.
    - 매핑 정보만 넣을 수 있고, 데이터 추가는 불가능
- 연결 테이블이 숨겨져 있어 예상치 못한 쿼리가 생성될 수 있음.

##### 다대다 매핑의 한계 극복

- 연결 테이블용 엔티티 추가
- `@ManyToMany` -> `@OneToMany`, `@ManyToOne`
- 매핑 시에 독립적으로 사용될 수 있도록 generated id 사용 권장